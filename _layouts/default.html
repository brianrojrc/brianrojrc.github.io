<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} - Brian Rojas{% else %}Brian Rojas{% endif %}</title>
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- Sidebar Navigation -->
    <nav class="sidebar-nav" id="sidebarNav">
        <div class="nav-header">
            <a href="{{ '/' | relative_url }}" class="site-title">Brian Rojas</a>
        </div>
        <ul class="nav-links">
            <li><a href="{{ '/' | relative_url }}" {% if page.url == "/" %}class="active"{% endif %}>Home</a></li>
            <li><a href="{{ '/about' | relative_url }}" {% if page.url contains 'about' %}class="active"{% endif %}>About</a></li>
            <li><a href="{{ '/projects' | relative_url }}" {% if page.url contains 'projects' %}class="active"{% endif %}>Projects</a></li>
            <li><a href="{{ '/research' | relative_url }}" {% if page.url contains 'research' %}class="active"{% endif %}>Research</a></li>
            <li><a href="{{ '/blog' | relative_url }}" {% if page.url contains 'blog' or page.url contains 'posts' %}class="active"{% endif %}>Blog</a></li>
            <li><a href="{{ '/contact' | relative_url }}" {% if page.url contains 'contact' %}class="active"{% endif %}>Contact</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            {{ content }}
        </div>
    </main>
    
    {% include footer.html %}

    <!-- Mathematical Background -->
    <div class="math-background" id="mathBackground"></div>

    <!-- Scripts -->
    <script>
        // Mobile Menu Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebarNav = document.getElementById('sidebarNav');
            
            if (mobileMenuToggle && sidebarNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    this.classList.toggle('active');
                    sidebarNav.classList.toggle('active');
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(event) {
                    const isClickInsideNav = sidebarNav.contains(event.target);
                    const isClickOnToggle = mobileMenuToggle.contains(event.target);
                    
                    if (!isClickInsideNav && !isClickOnToggle && sidebarNav.classList.contains('active')) {
                        mobileMenuToggle.classList.remove('active');
                        sidebarNav.classList.remove('active');
                    }
                });
                
                // Close menu when clicking a link
                const navLinks = sidebarNav.querySelectorAll('a');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenuToggle.classList.remove('active');
                        sidebarNav.classList.remove('active');
                    });
                });
            }
        });

        // Mathematical Background Generator
        const equations = [
            // Partial Derivatives
            '∂V/∂t',
            '∂²V/∂S²',
            '∂V/∂S',
            '∂f/∂x',
            '∂²f/∂x∂y',
            '∇f',
            
            // Greeks
            'Δ', 'Γ', 'θ', 'ν', 'ρ',
            'α', 'β', 'γ', 'λ', 'σ', 'μ',
            
            // Volatility
            'σ²',
            'σᵢₘₚₗᵢₑd',
            'σₗₒcₐₗ',
            'dW',
            
            // Machine Learning
            '∇θJ',
            '∂L/∂W',
            'η∇J',
            'ReLU(x)',
            
            // Stochastic Calculus
            'dS = μdt + σdW',
            'E[dW²] = dt',
            
            // Symbols
            '∫', '∑', '∂', '∇', 'Σ', 'Θ', 'Λ'
        ];

        function createMathBackground() {
            const container = document.getElementById('mathBackground');
            if (!container) return;
            
            const numberOfEquations = 20; // Reduced from 50
            
            for (let i = 0; i < numberOfEquations; i++) {
                const equation = document.createElement('div');
                equation.className = 'math-equation';
                
                // Random equation
                equation.textContent = equations[Math.floor(Math.random() * equations.length)];
                
                // Random size
                const sizes = ['small', 'medium', 'large'];
                equation.classList.add(sizes[Math.floor(Math.random() * sizes.length)]);
                
                // Random position
                equation.style.left = Math.random() * 100 + '%';
                equation.style.top = Math.random() * 100 + '%';
                
                // Random animation delay
                equation.style.animationDelay = Math.random() * 10 + 's';
                
                // Random animation duration
                equation.style.animationDuration = (15 + Math.random() * 25) + 's';
                
                container.appendChild(equation);
            }
        }

        // Initialize math background
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', createMathBackground);
        } else {
            createMathBackground();
        }
    </script>
</body>
</html>
